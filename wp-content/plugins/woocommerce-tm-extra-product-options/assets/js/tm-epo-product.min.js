!function(t,a,i,r){"use_strict";var e=function(t,a,i,r,e){var o=this;o.field=a,o.currentCart=i,o.variableProductContainers=r,o.epoObject=e,o.$form=t,o.$wrap=t.closest(".tc-epo-element-product-container-wrap"),o.$attributeFields=t.find(".tc-epo-variable-product-selector"),o.$singleVariation=t.find(".tc-epo-element-single-variation"),o.$resetVariations=t.find(".tc-epo-element-variable-reset-variations"),o.variationData=t.data("product_variations"),o.useAjax=!1===o.variationData,o.xhr=!1,o.loading=!0,o.variationId=t.closest(".cpf_hide_element").find(".tc-epo-element-product-container-variation-id input.product-variation-id"),o.getChosenAttributes=o.getChosenAttributes.bind(o),o.findMatchingVariations=o.findMatchingVariations.bind(o),o.isMatch=o.isMatch.bind(o),o.toggleResetLink=o.toggleResetLink.bind(o),t.on("click.tc-variation-form",".tc-epo-element-variable-reset-variations",{variationForm:o},o.onReset),t.on("tc_hide_variation",{variationForm:o},o.onHide),t.on("tc_show_variation",{variationForm:o},o.onShow),t.on("tc_reset_data",{variationForm:o},o.onResetDisplayedVariation),t.on("tc_reset_image",{variationForm:o},o.onResetImage),t.on("change.tc-variation-form",".tc-epo-variable-product-selector",{variationForm:o},o.onChange),t.on("tc_found_variation.tc-variation-form",{variationForm:o},o.onFoundVariation),t.on("tc_check_variations.tc-variation-form",{variationForm:o},o.onFindVariation),t.on("tc_update_variation_values.tc-variation-form",{variationForm:o},o.onUpdateAttributes),t.on("refresh.tc-variation-form",{variationForm:o},o.onRefreshContainer),t.on("update_field.tc-variation-form",{variationForm:o},o.onUpdateField),o.variationId.val(""),setTimeout(function(){t.trigger("refresh"),t.trigger("tc_variation_form"),o.loading=!1},100)};e.prototype.onRefreshContainer=function(t,a){var i=t.data.variationForm;i.variableProductContainers.find(".tc-epo-element-product-container").removeClass("variations_form"),i.$form.addClass("variations_form"),i.$form.trigger("tc_check_variations.tc-variation-form")},e.prototype.onUpdateField=function(t,a){var i,r,e,o,n,c,s=t.data.variationForm;t.preventDefault(),a||(r=i=s.field,i.is("select")&&(r=i.find("option:selected")),e=0,o=0,n=0,c=0,i.data("price_set",1),r.data("associated_price_set",1),r.data("price_set",1),r.data("raw_price",o),r.data("raw_original_price",c),r.data("price",e),r.data("original_price",n),i.data("price-changed",1),s.$form.trigger({type:"tm-epo-update",norules:2}),s.currentCart.trigger({type:"tm-epo-update",norules:2}))},e.prototype.onReset=function(t){t.preventDefault(),t.data.variationForm.$attributeFields.val("").change(),t.data.variationForm.$form.trigger("tc_reset_data")},e.prototype.onHide=function(t){t.preventDefault()},e.prototype.onShow=function(t,a,i){t.preventDefault()},e.prototype.onResetDisplayedVariation=function(t){var a=t.data.variationForm;a.$form.find(".product-meta").find(".tc-product-sku").tc_reset_content(),a.$form.trigger("tc_reset_image"),a.$singleVariation.slideUp(200).trigger("tc_hide_variation")},e.prototype.onResetImage=function(t){t.data.variationForm.$form.tc_variations_image_update(!1)},e.prototype.onFindVariation=function(a){var i,r=a.data.variationForm,e=r.getChosenAttributes(),o=e.data;if(e.count===e.chosenCount)if(r.useAjax){if(void 0===typeof wc_add_to_cart_variation_params)return;r.xhr&&r.xhr.abort(),i=r.$form.closest(".cpf-type-product"),r.$form.block({message:null,overlayCSS:{background:"#fff",opacity:.6}}),o.product_id=parseInt(r.$form.data("product_id"),10),o.discount=i.attr("data-discount"),o.discount_type=i.attr("data-discount-type"),r.xhr=t.ajax({url:wc_add_to_cart_variation_params.wc_ajax_url.toString().replace("%%endpoint%%","get_variation"),type:"POST",data:o,success:function(t){t?r.$form.trigger("tc_found_variation",[t]):(r.$form.trigger("tc_reset_data"),e.chosenCount=0,r.loading||(r.$form.find(".tc-epo-element-single-variation").after('<p class="wc-no-matching-variations woocommerce-info">'+wc_add_to_cart_variation_params.i18n_no_matching_variations_text+"</p>"),r.$form.find(".wc-no-matching-variations").slideDown(200),r.$form.trigger("update_field",[])))},complete:function(){r.$form.unblock()}})}else{r.$form.trigger("tc_update_variation_values");var n=r.findMatchingVariations(r.variationData,o).shift();n?r.$form.trigger("tc_found_variation",[n]):(r.$form.trigger("tc_reset_data"),e.chosenCount=0,r.loading||(r.$form.find(".tc-epo-element-single-variation").after('<p class="wc-no-matching-variations woocommerce-info">'+wc_add_to_cart_variation_params.i18n_no_matching_variations_text+"</p>"),r.$form.find(".wc-no-matching-variations").slideDown(200)))}else r.variationId.val("").change(),r.$form.trigger("update_field",[]),r.$form.trigger("tc_update_variation_values"),r.$form.trigger("tc_reset_data");r.toggleResetLink(e.chosenCount>0)},e.prototype.onFoundVariation=function(a,i){var r=a.data.variationForm,e=r.$form.find(".product-meta").find(".tc-product-sku"),n=r.$wrap.find(".tm-quantity, .tm-quantity-alt"),c=n.find("input.tm-qty, input.tm-qty-alt"),s=t.epoAPI.math.toInt(c.attr("data-min")),_=t.epoAPI.math.toInt(c.attr("data-max")),d=!0,v=!1,m="";i.sku?e.tc_set_content(i.sku):e.tc_reset_content(),r.$form.tc_variations_image_update(i),i.variation_is_visible?(v=o("variation-template"),i.variation_id):v=o("unavailable-variation-template"),r.field.attr("data-no-price")&&(i.display_price="",i.display_regular_price="",i.price_html=""),m=(m=(m=v({variation:i})).replace("/*<![CDATA[*/","")).replace("/*]]>*/",""),r.$singleVariation.html(m),r.variationId.val(i.variation_id).change(),"yes"===i.is_sold_individually?(c.val("1").attr("min","1").attr("max","1"),n.hide()):(""!==i.min_qty&&i.min_qty<s&&(s=i.min_qty),""!==i.max_qty&&i.max_qty<_&&(_=i.max_qty),s&&c.attr("min",s),_&&c.attr("max",_),_&&t.epoAPI.math.toInt(c.val())>_&&c.val(_),n.show()),i.is_purchasable&&i.is_in_stock&&i.variation_is_visible||(d=!1),t.trim(r.$singleVariation.text())?r.$singleVariation.slideDown(200).trigger("tc_show_variation",[i,d]):r.$singleVariation.show().trigger("tc_show_variation",[i,d]),r.$form.trigger("update_field",[i])},e.prototype.onChange=function(t){var a=t.data.variationForm;a.variationId.val("").change(),a.$form.find(".wc-no-matching-variations").remove(),a.useAjax?a.$form.trigger("tc_check_variations"):(a.$form.trigger("woocommerce_variation_select_change"),a.$form.trigger("tc_check_variations")),a.$form.trigger("woocommerce_variation_has_changed")},e.prototype.onUpdateAttributes=function(a){var i=a.data.variationForm,r=i.getChosenAttributes().data;i.useAjax||(i.$attributeFields.each(function(a,e){var o=t(e),n=o.data("attribute_name")||o.attr("name"),c=t(e).data("show_option_none"),s=":gt(0)",_=0,d=t("<select/>"),v=o.val()||"",m=!0;if(!o.data("attribute_html")){var l=o.clone();l.find("option").removeAttr("disabled attached").removeAttr("selected"),o.data("attribute_options",l.find("option"+s).get()),o.data("attribute_html",l.html())}d.html(o.data("attribute_html"));var f=t.extend(!0,{},r);f[n]="";var g=i.findMatchingVariations(i.variationData,f);for(var p in g)if(void 0!==g[p]){var u=g[p].attributes;for(var h in u)if(u.hasOwnProperty(h)){var w=u[h],y="";if(h===n)if(g[p].variation_is_active&&(y="enabled"),w){w=t("<div/>").html(w).text();var b=d.find("option");if(b.length)for(var $=0,F=b.length;$<F;$++){var x=t(b[$]);if(w===x.val()){x.addClass("attached "+y);break}}}else d.find("option:gt(0)").addClass("attached "+y)}}_=d.find("option.attached").length,v&&(m=!1,0!==_&&d.find("option.attached.enabled").each(function(){var a=t(this).val();if(v===a)return m=!0,!1})),_>0&&v&&m&&"no"===c&&(d.find("option:first").remove(),s=""),d.find("option"+s+":not(.attached)").remove(),o.html(d.html()),o.find("option"+s+":not(.enabled)").prop("disabled",!0),v?m?o.val(v):o.val("").change():o.val("")}),i.$form.trigger("woocommerce_update_variation_values"))},e.prototype.getChosenAttributes=function(){var a={},i=0,r=0;return this.$attributeFields.each(function(){var e=t(this).data("attribute_name")||t(this).attr("name"),o=t(this).val()||"";o.length>0&&r++,i++,a[e]=o}),{count:i,chosenCount:r,data:a}},e.prototype.findMatchingVariations=function(t,a){for(var i=[],r=0;r<t.length;r++){var e=t[r];this.isMatch(e.attributes,a)&&i.push(e)}return i},e.prototype.isMatch=function(t,a){var i=!0;for(var r in t)if(t.hasOwnProperty(r)){var e=t[r],o=a[r];void 0!==e&&void 0!==o&&0!==e.length&&0!==o.length&&e!==o&&(i=!1)}return i},e.prototype.toggleResetLink=function(t){t?"hidden"===this.$resetVariations.css("visibility")&&this.$resetVariations.css("visibility","visible").hide().fadeIn():this.$resetVariations.css("visibility","hidden")},t.fn.tc_product_variation_form=function(t,a,i,r){return new e(this,t,a,i,r),this.trigger("tc_product_variation_form"),this},t.fn.tc_set_content=function(t){void 0===this.attr("data-o_content")&&this.attr("data-o_content",this.text()),this.text(t)},t.fn.tc_reset_content=function(){void 0!==this.attr("data-o_content")&&this.text(this.attr("data-o_content"))},t.fn.tc_set_variation_attr=function(t,a){void 0===this.attr("data-o_"+t)&&this.attr("data-o_"+t,this.attr(t)?this.attr(t):""),!1===a?this.removeAttr(t):this.attr(t,a)},t.fn.tc_reset_variation_attr=function(t){void 0!==this.attr("data-o_"+t)&&this.attr(t,this.attr("data-o_"+t))},t.fn.tc_variations_image_update=function(t){var a=this,i=a.find(".tc-product-image, .woocommerce-product-gallery__image, .woocommerce-product-gallery__image--placeholder").eq(0),r=i.find(".wp-post-image"),e=i.find("a").eq(0);t&&t.image&&t.image.src&&t.image.src.length>1?(r.tc_set_variation_attr("src",t.image.src),r.tc_set_variation_attr("height",t.image.src_h),r.tc_set_variation_attr("width",t.image.src_w),r.tc_set_variation_attr("srcset",t.image.srcset),r.tc_set_variation_attr("sizes",t.image.sizes),r.tc_set_variation_attr("title",t.image.title),r.tc_set_variation_attr("data-caption",t.image.caption),r.tc_set_variation_attr("alt",t.image.alt),r.tc_set_variation_attr("data-src",t.image.full_src),r.tc_set_variation_attr("data-large_image",t.image.full_src),r.tc_set_variation_attr("data-large_image_width",t.image.full_src_w),r.tc_set_variation_attr("data-large_image_height",t.image.full_src_h),i.tc_set_variation_attr("data-thumb",t.image.src),e.tc_set_variation_attr("href",t.image.full_src)):a.tc_variations_image_reset()},t.fn.tc_variations_image_reset=function(){var t=this.find(".tc-product-image, .woocommerce-product-gallery__image, .woocommerce-product-gallery__image--placeholder").eq(0),a=t.find(".wp-post-image"),i=t.find("a").eq(0);a.tc_reset_variation_attr("src"),a.tc_reset_variation_attr("width"),a.tc_reset_variation_attr("height"),a.tc_reset_variation_attr("srcset"),a.tc_reset_variation_attr("sizes"),a.tc_reset_variation_attr("title"),a.tc_reset_variation_attr("data-caption"),a.tc_reset_variation_attr("alt"),a.tc_reset_variation_attr("data-src"),a.tc_reset_variation_attr("data-large_image"),a.tc_reset_variation_attr("data-large_image_width"),a.tc_reset_variation_attr("data-large_image_height"),t.tc_reset_variation_attr("data-thumb"),i.tc_reset_variation_attr("href")};var o=function(t){var r=i.getElementById("tmpl-"+t).textContent,e=!1;return e=e||/<#\s?data\./.test(r),e=e||/{{{?\s?data\.(?!variation\.).+}}}?/.test(r),(e=e||/{{{?\s?data\.variation\.[\w-]*[^\s}]/.test(r))?wp.template(t):function(t){var i=t.variation||{};return r.replace(/({{{?)\s?data\.variation\.([\w-]*)\s?(}}}?)/g,function(t,r,e,o){if(r.length!==o.length)return"";var n=i[e]||"";return 2===r.length?a.escape(n):n})}}}(window.jQuery,window,document);