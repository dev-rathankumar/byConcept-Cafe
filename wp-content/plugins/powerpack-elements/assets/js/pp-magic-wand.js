!function(e){var n=["powerpack","pp_section","pp_column"],t=["widget","column","section"];xdLocalStorage.init({iframeUrl:pp_magic_wand.cross_domain_cdn,initCallback:function(){}}),PPMWHandler={copy:function(e,n){xdLocalStorage.setItem("ppe_container_new",JSON.stringify({widgetType:e,widgetCode:n}))},paste:function(e,n){var t=null,i=(e=e.widgetCode,JSON.stringify(e)),a={elType:e.elType,settings:e.settings},o=/\.(jpg|jpeg|png|gif|svg)/gi.test(i),r=n,c=n.model.get("elType"),p={index:0};switch(e.elType){case"section":switch(a.elements=PPMWHandler.generateUniqueID(e.elements),t=elementor.getPreviewContainer(),c){case"widget":p.index=r.getContainer().parent.parent.view.getOption("_index")+1;break;case"column":p.index=r.getContainer().parent.view.getOption("_index")+1;break;case"section":p.index=r.getOption("_index")+1}break;case"column":switch(a.elements=PPMWHandler.generateUniqueID(e.elements),c){case"widget":t=r.getContainer().parent.parent,p.index=r.getContainer().parent.view.getOption("_index")+1;break;case"column":t=r.getContainer().parent,p.index=r.getOption("_index")+1;break;case"section":t=r.getContainer()}break;case"widget":switch(a.widgetType=e.widgetType,t=r.getContainer(),c){case"widget":t=r.getContainer().parent,p.index=r.getOption("_index")+1;break;case"column":t=r.getContainer();break;case"section":t=r.children.findByIndex(0).getContainer()}}var d=PPMWHandler.createElement(r,c,{model:a,container:t,options:p});o&&PPMWHandler.processMedia(d,i,function(e){if(e.success){var n=e.data[0];a.elType=n.elType,a.settings=n.settings,"widget"===n.elType?a.widgetType=n.widgetType:a.elements=n.elements,d.view.$el.removeClass("ppe-processing-import").attr("data-pp-processing-import-title","Image processing completed.");var i=setTimeout(function(){$e.run("document/elements/delete",{container:d}),$e.run("document/elements/create",{model:a,container:t,options:p}),clearTimeout(i)},750)}})},createElement:function(e,n,t){var i=$e.run("document/elements/create",t);return null==i&&("widget"===n?e.$el.next(".undefined.elementor-widget-empty")&&e.$el.next(".undefined.elementor-widget-empty").after('<div class="elementor-alert elementor-alert-warning">'+pp_magic_wand.widget_not_found+"</div>"):e.$el.find(".undefined.elementor-widget-empty")&&e.$el.find(".undefined.elementor-widget-empty").after('<div class="elementor-alert elementor-alert-warning">'+pp_magic_wand.widget_not_found+"</div>")),i},processMedia:function(n,t,i){e.ajax({url:pp_magic_wand.ajaxURL,method:"post",data:{nonce:pp_magic_wand.nonce,action:"pp_process_import",content:t},beforeSend:function(){n.view.$el.addClass("ppe-processing-import").attr("data-pp-processing-import-title","Processing images...")}}).done(function(e){"function"==typeof i&&i(e)})},generateUniqueID:function(e){return e.forEach(function(e,n){e.id=elementor.helpers.getUniqueID(),e.elements.length>0&&PPMWHandler.generateUniqueID(e.elements)}),e},getSectionData:function(n,t,i,a){void 0!==n&&void 0!==t&&(void 0===i&&(i=1),e.post(pp_magic_wand.ajaxURL,{action:"pp_get_section_data",post_id:n,section_id:t,nonce:i},function(e){e.success&&PPMWHandler.copy("section",e.data),"function"==typeof a&&a(e)}))}},"undefined"!=typeof elementor&&n.forEach(function(e,i){elementor.hooks.addFilter("elements/"+t[i]+"/contextMenuGroups",function(e,t){return e.push({name:n[i],actions:[{name:"copy",title:pp_magic_wand.pp_copy,icon:pp_magic_wand.cross_domain_icon,callback:function(){var e=t.model.get("widgetType"),n=t.model.toJSON();PPMWHandler.copy(e,n)}},{name:"paste",title:pp_magic_wand.pp_paste,icon:pp_magic_wand.cross_domain_icon,callback:function(){var e="";xdLocalStorage.getItem("ppe_container_new",function(n){e=JSON.parse(n.value),PPMWHandler.paste(e,t)})}}]}),e})})}(jQuery);