"use strict";class StickyHeader{constructor(){this.$tbayHeader=$("#tbay-header"),this.$isExistedEventMiniCartClick=!1,this.$tbayHeader.hasClass("main-sticky-header")&&this._initStickyHeader(),this._widgetProducts(),$(".search-horizontal .btn-search-totop").on("click",function(){$(".container-search-horizontal").toggleClass("active")}),this._clickHorizontalSearch()}_initStickyHeader(){var e=this,t=$(window).width(),a=this._getHeaderHeight();$(window).scroll(function(){$("#tbay-top-cart").height()>0&&$("#tbay-top-cart.tbay-top-cart.v1").height();if(t>=1024)if($(this).scrollTop()>a){if(e.$tbayHeader.hasClass("sticky-header1"))return;e._stickyHeaderOnDesktop(a)}else e.$tbayHeader.next().css("margin-top",0),e.$tbayHeader.css("top",0).removeClass("sticky-header1"),$("#tbay-header.header-v8 .search-full").slideToggle(500);t<=767&&e._fixedHeaderOnMobile()})}_fixedHeaderOnMobile(){$("body").hasClass("post-type-archive-product")&&($(".archive-shop .tbay-filter + .products").offset().top-$(window).scrollTop()<99?($(".archive-shop .tbay-filter").next().css("margin-top",$(".archive-shop .tbay-filter").height()+20),$(".archive-shop .tbay-filter").addClass("fixed").css("top",36+$("#wpadminbar").outerHeight())):($(".archive-shop .tbay-filter").css("top",0),$(".archive-shop .tbay-filter").removeClass("fixed"),$(".archive-shop .tbay-filter").next().css("margin-top",0)))}_stickyHeaderOnDesktop(e){this.$tbayHeader.hasClass("sticky-header1")||(this.$tbayHeader.addClass("sticky-header1").css("top",$("#wpadminbar").outerHeight()),$("#tbay-top-cart").slideUp(500,function(){}),$("#tbay-header.header-v8 .search-full").slideUp(500,function(){}),this.$tbayHeader.next().css("margin-top",e),this.$isExistedEventMiniCartClick||$("#tbay-header.sticky-header1 .tbay-topcart a.mini-cart.v1").on("click",()=>{this.$isExistedEventMiniCartClick=!0;$("html, body").scrollTop(0)}))}_getHeaderHeight(){return this.$tbayHeader.height()}_widgetProducts(){$(".widget-products").hasClass("carousel-blur")&&($(".widget-products.carousel-blur").parents('.vc_row[data-vc-full-width="true"]').addClass("tbay-product-carousel-blur"),$(".widget-products.carousel-blur").parents(".elementor-section-stretched.elementor-section-full_width").addClass("elementor-product-carousel-blur")),$(".widget-products").hasClass("special-home5")&&($(".widget-products.special-home5").parents('.vc_row[data-vc-full-width="true"]').addClass("tbay-product-special-home5"),$(".widget-products.special-home5").parents(".elementor-section-stretched.elementor-section-full_width").addClass("elementor-product-special-home5"))}_clickHorizontalSearch(){var e=$(".search-horizontal .btn-search-totop, .container-search-horizontal,.ui-autocomplete.ui-widget-content.style1.horizontal");$(window).on("click.Bst",function(t){0!=e.has(t.target).length||e.is(t.target)||$(".container-search-horizontal").removeClass("active")})}}class AutoComplete{constructor(){jQuery(window).width()>=1024&&this._callAjaxSearch()}_callAjaxSearch(){var e=this,t=this._getTop(),a=jQuery("input[name=s]:visible");a.autocomplete({source:function(e,t){jQuery.ajax({url:puca_settings.ajaxurl+"?callback=?&action=puca_autocomplete_search",dataType:"json",data:{term:e.term,category:this.element.parent().find(".dropdown_product_cat").val(),style:this.element.data("style"),post_type:this.element.parent().find(".post_type").val()},success:function(e,a,s){t(e)}})},position:{my:"left+0 top+"+t},minLength:2,autoFocus:!0,search:function(e){jQuery(e.currentTarget).parents(".tbay-search-form").addClass("load")},select:function(e,t){window.location.href=t.item.link},create:function(){jQuery(this).data("ui-autocomplete")._renderItem=function(e,t){a="";if(e.addClass(t.style),""!=t.image)var a='<a href="'+t.link+'" title="'+t.label+'"><img src="'+t.image+'" ></a>';return a=a+'<div class="group"><div class="name"><a href="'+t.link+'" title="'+t.label+'">'+t.label+"</a></div>",""!=t.price&&(a=a+'<div class="price">'+t.price+"</div></div> "),jQuery("<li>").append(a).appendTo(e)},jQuery(this).data("ui-autocomplete")._renderMenu=function(e,t){var s=this;jQuery.each(t,function(t,a){s._renderItemData(e,a)}),void 0!==a.data("style")&&"search-min"!=a.data("style")?t[0].view_all?e.append('<li class="list-header ui-menu-divider">'+t[0].result+'<a id="search-view-all" data-id="#'+this.element.parents("form").attr("id")+'" href="javascript:void(0)">'+puca_settings.view_all+"</a></li>"):e.append('<li class="list-header ui-menu-divider">'+t[0].result+"</li>"):t[0].view_all?(e.append('<li class="list-header ui-menu-divider">'+t[0].result+"</li>"),e.append('<li class="list-bottom ui-menu-divider"><a id="search-view-all" data-id="#'+this.element.parents("form").attr("id")+'" href="javascript:void(0)">'+puca_settings.view_all+"</a></li>")):e.append('<li class="list-header ui-menu-divider">'+t[0].result+"</li>"),$(document.body).trigger("puca_search_view_all")}},response:(t,a)=>{e._autoCompeleteResponse(a.content.length)},open:(e,t)=>{$(e.target).parents(".tbay-search-form").removeClass("load");$(e.target).parents(".tbay-search-form").addClass("active");var a=$(e.target).parents("form").outerWidth();var s=$(e.target).parents("form").offset().left;jQuery(e.target).autocomplete("widget").css({width:a,left:s})},close:t=>{e._autoCompeleteClose(t)}}),$(".tbay-preloader").on("click",function(){e._onClickTbayPreloader(event)}),$(document.body).on("puca_search_view_all",()=>{$("#search-view-all").on("click",function(){$($(this).data("id")).submit()})})}_getTop(){let e=0;switch(jQuery("input[name=s]:visible").data("style")){case"style1 home5":e=-47;break;case"style1 home6":e=20;break;case"style1":e=24;break;case"style1 home5 home8":e=-45}return e}_onClickTbayPreloader(e){jQuery(e.currentTarget).parents(".tbay-search-form").removeClass("active"),jQuery(e.currentTarget).parents(".tbay-search-form").find("input[name=s]").val(""),jQuery(".tbay-preloader").removeClass("no-results")}_autoCompeleteResponse(e){let t=jQuery(".tbay-preloader");0===e?(t.text(puca_settings.no_results),t.addClass("no-results"),t.parents(".tbay-search-form").removeClass("load"),t.parents(".tbay-search-form").addClass("active")):(t.empty(),t.removeClass("no-results"))}_autoCompeleteClose(e){jQuery(e.target).parents(".tbay-search-form").removeClass("load"),jQuery(e.target).parents(".tbay-search-form").removeClass("active")}}jQuery(document).ready(()=>{new StickyHeader;new AutoComplete});
